<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>DivWin: 4. How to use Process Objects</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript">
$(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">DivWin&#160;<span id="projectnumber">1.0v</span></div>
   <div id="projectbrief">Games Engine</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('_process_explanation.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<h1>4. How to use Process Objects </h1>  </div>
</div>
<div class="contents">
<div class="textblock"><p><a class="el" href="_w_tc_process_8h_source.html">WTcProcess.h</a></p>
<p>Using William Thorley’s Process Handler System</p>
<p>When properly implemented the process handler automatically links and runs all processes. A process must inherit <a class="el" href="classc_process.html" title="This is the base code for a process. This will automatically create a new process. It will hand itself to cKernel to be processed every frame. Any Processes created by the user should inherit this type to be handled by cKernel automatically. Initialisation code should go in the constructor of the user type. Linking to cKernel is performed automatically by cProcess. Update code should go in the function Run(). Destruction code should fo in the destructor of the user type. Code to handle interaction of two processes should go in either processes UserSignal() function.">cProcess</a>. It must also define the virtual function Run() a process without a Run() function is useless, and will be deleted during the frame it is created.</p>
<p>Declaring a new process class called player: </p>
<div class="fragment"><pre class="fragment"> <span class="comment">//This is the same as _PROCESS(player)</span>
 *<span class="keyword">class </span>player : <span class="keyword">public</span> <a class="code" href="classc_process.html" title="This is the base code for a process. This will automatically create a new process. It will hand itself to cKernel to be processed every frame. Any Processes created by the user should inherit this type to be handled by cKernel automatically. Initialisation code should go in the constructor of the user type. Linking to cKernel is performed automatically by cProcess. Update code should go in the function Run(). Destruction code should fo in the destructor of the user type. Code to handle interaction of two processes should go in either processes UserSignal() function.">cProcess</a>
 *{
         *<span class="keyword">public</span> :
         <span class="keywordtype">void</span> <a class="code" href="classc_process.html#a3e0fab4ccc0a8fb065d50eb88b6a0dd5" title="This Function stores the code which will update this process by a single frame. This user defined fun...">Run</a>();
         *};
         *
</pre></div><p>void <a class="el" href="classc_process.html#a3e0fab4ccc0a8fb065d50eb88b6a0dd5" title="This Function stores the code which will update this process by a single frame. This user defined fun...">cProcess::Run()</a>; The function Run() is a virtual function already defined. This function is called every time the process must run its code (usually once a frame). The code that defines how the process acts goes in Run().</p>
<p>Creating a Process: Call the macro _CREATE(Type); This will return a pointer to the new process of type Type. </p>
<div class="fragment"><pre class="fragment"> player *mpNewProcessPointer;
 NewProcessPointer=_CREATE(player());
 _CREATE(AnotherProcess(Argument1,Argument2));
</pre></div><p>Killing a Process: Process' must not be destroyed by deleting the process. Processes can be be deleted either by calling the macro _KILL(); or by calling the Function Signal(SIGNAL lsFlags) with the flag _S_KILL. if _KILL() is called without a pointer it will automatically use the pointer this. Process' will not be destroyed when the signal is sent, they will be deacticated, but the memory will remain allocated until <a class="el" href="classc_kernel.html" title="Kernel Object. Handles Processes. Tracks, runs and deletes current processes. Has complete control ov...">cKernel</a> reaches the correct stage to delete the object. Objects can remain allocated into the next frame, but not the frame after that. Both pieces of following code have the same effect. The Process pointed to by mpPointerToAnotherProcess is Killed and then this process is killed. </p>
<div class="fragment"><pre class="fragment"> <span class="keywordtype">void</span> <a class="code" href="classc_process.html#a3e0fab4ccc0a8fb065d50eb88b6a0dd5" title="This Function stores the code which will update this process by a single frame. This user defined fun...">player::Run</a>()
 {

 <span class="keywordflow">if</span>(_KEY(KEY_k))
 {
 mpPointerToAnotherProcess-&gt;Signal(_S_KILL);
 _KILL(<span class="keyword">this</span>);
 }

 }
</pre></div><div class="fragment"><pre class="fragment"> <span class="keywordtype">void</span> <a class="code" href="classc_process.html#a3e0fab4ccc0a8fb065d50eb88b6a0dd5" title="This Function stores the code which will update this process by a single frame. This user defined fun...">player::Run</a>()
 {

 <span class="keywordflow">if</span>(_KEY(KEY_k))
 {
 _KILL(mpPointerToAnotherProcess);
 _KILL();
 }

 }
</pre></div><p>Sleeping a Process: A Process can be sent to sleep by calling the <a class="el" href="classc_signal.html#a77af8271fc7ffb8696ba73a01e213808" title="This is the function that will handle a system signal. Possible signals to be passed in are _S_SLEEP...">cSignal::Signal(SIGNAL lsFlags)</a> function with the value _S_SLEEP. Sleeping a process leaves the process in the process list, but stops the Run() function being called every frame. This allows the Signal(SIGNAL lsFlags) function to be used to return it to ‘active duty’. The memory will remain allocated. Sending repeated Sleep calls to a process will not affect the process or the stability of the system, the Process will remain asleep.</p>
<p>Waking a Process: A Process can be awakend by calling the <a class="el" href="classc_signal.html#a77af8271fc7ffb8696ba73a01e213808" title="This is the function that will handle a system signal. Possible signals to be passed in are _S_SLEEP...">cSignal::Signal(SIGNAL lsFlags)</a> function with the value _S_WAKE. Sending repeated Waking calls to a process will not affect the process or the stability of the system, the Process will remain awake. </p>
<div class="fragment"><pre class="fragment"> <span class="keywordtype">void</span> <a class="code" href="classc_process.html#a3e0fab4ccc0a8fb065d50eb88b6a0dd5" title="This Function stores the code which will update this process by a single frame. This user defined fun...">player::Run</a>()
 {

 <span class="keywordflow">if</span>(_KEY(KEY_s)) mpPointerToAnotherProcess-&gt;Signal(_S_SLEEP);
 <span class="keywordflow">if</span>(_KEY(KEY_w)) mpPointerToAnotherProcess-&gt;Signal(_S_WAKE);

 }
</pre></div><p>Removing a Process: A Process can be killed by the <a class="el" href="classc_kernel.html" title="Kernel Object. Handles Processes. Tracks, runs and deletes current processes. Has complete control ov...">cKernel</a> object. Calling the <a class="el" href="classc_kernel.html#a59c9a956e6a6666a57c2d85e463381d8">cKernel::Remove()</a> function will kill the process and free the memory. This must not be done to the currently running process or the system may crash. Use on the current process at your peril. The pointer is to the <a class="el" href="classc_linked_node.html">cLinkedNode&lt;vProcess&gt;</a> which owns this process. Each Process has a pointer (mpNode) to its <a class="el" href="classc_linked_node.html">cLinkedNode&lt;vProcess&gt;</a>. * </p>
<div class="fragment"><pre class="fragment"> <span class="keywordtype">void</span> <a class="code" href="classc_process.html#a3e0fab4ccc0a8fb065d50eb88b6a0dd5" title="This Function stores the code which will update this process by a single frame. This user defined fun...">player::Run</a>()
 {

 <span class="keywordflow">if</span>(_KEY(KEY_k)) _KERNEL-&gt;Remove(mpPointerToAProcessesNode);

 }
</pre></div> </div></div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="footer">Generated on Sun Sep 11 2011 13:58:40 for DivWin by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </li>
    </ul>
  </div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Friends</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>


</body>
</html>
